(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[104],{459:(e,a,t)=>{Promise.resolve().then(t.bind(t,7746))},837:e=>{e.exports={dashboard:"app_dashboard__CLE5l",sidebar:"app_sidebar__mEgQl",sidebar__header:"app_sidebar__header__XCGER",sidebar__nav:"app_sidebar__nav__hamVG",active:"app_active__dPqO8",sidebar__footer:"app_sidebar__footer__970jN",content:"app_content__7IxbH",content__header:"app_content__header__KGob0",content__card:"app_content__card__WgF_T",content__card__stats:"app_content__card__stats__84M8b",authLoading:"app_authLoading__rYJvP",authError:"app_authError__E1poB","stat-card":"app_stat-card__zThVn",value:"app_value__A7nx1",icon:"app_icon___3bqa"}},2767:e=>{e.exports={container:"post_container__PmtzR",sidebar:"post_sidebar__KY3vn",main:"post_main__xaUGK",card:"post_card__lQ1BO",title:"post_title__VkWuY",formGroup:"post_formGroup__bbP9F",formGroup__label:"post_formGroup__label__Lk8C_",formGroup__input:"post_formGroup__input__gShw5",formGroup__textarea:"post_formGroup__textarea__zWTxw",submitButton:"post_submitButton__GMWr5"}},5671:(e,a,t)=>{"use strict";t.d(a,{I:()=>n});var r=t(5155);let s={"x-circle":"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0-9.414l2.828-2.829 1.415 1.415L13.414 12l2.829 2.828-1.415 1.415L12 13.414l-2.828 2.829-1.415-1.415L10.586 12 7.757 9.172l1.415-1.415L12 10.586z","check-circle":"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.997-6l7.07-7.071-1.414-1.414-5.656 5.657-2.829-2.829-1.414 1.414L11.003 16z",clock:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm1-8h4v2h-6V7h2v5z",bell:"M12 22a2.98 2.98 0 0 0 2.818-2H9.182A2.98 2.98 0 0 0 12 22zm7-7.414V10c0-3.217-2.185-5.927-5.145-6.742C13.562 2.52 12.846 2 12 2s-1.562.52-1.855 1.258C7.185 4.074 5 6.783 5 10v4.586l-1.707 1.707A1 1 0 0 0 3 17v1a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-1a1 1 0 0 0-.293-.707L19 14.586z",dashboard:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z",close:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",logout:"M16 13v-2H7V8l-5 4 5 4v-3z M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"},n=e=>{let{name:a,size:t=24,className:n=""}=e,o=s[a];return o?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:t,height:t,className:n,children:(0,r.jsx)("path",{d:o})}):(console.warn('Icon "'.concat(a,'" not found')),null)}},7440:(e,a,t)=>{"use strict";let r,s;t.d(a,{j6:()=>p});var n=t(2479),o=t(7016),i=t(3681),l=t(7398);r=0===(0,n.Dk)().length?(0,n.Wp)({apiKey:"AIzaSyAjmdbaSlO2PJtnThYOI9mrpsoBgq6JWDc",authDomain:"pt-admin-4d877.firebaseapp.com",projectId:"pt-admin-4d877",storageBucket:"pt-admin-4d877.firebasestorage.app",messagingSenderId:"420928013456",appId:"1:420928013456:web:42cde435f10b1949c30415",measurementId:"G-9GWH9VTJP6"}):(0,n.Sx)();let c="appExpo";try{s=(0,n.Sx)(c)}catch(e){s=(0,n.Wp)({apiKey:"AIzaSyBTE5Gpz4rnnVhlDXQA3Va4DNARIhhJhrk",authDomain:"pawticket-6b651.firebaseapp.com",projectId:"pawticket-6b651",storageBucket:"pawticket-6b651.firebasestorage.app",messagingSenderId:"405389818227",appId:"1:405389818227:web:0f77dc15826b1eac13ed06",measurementId:"G-5YNTM317YJ"},c)}let p=(0,o.xI)(r);(0,i.aU)(r),(0,l.c7)(r),(0,i.aU)(s),(0,l.c7)(s)},7746:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>p});var r=t(5155),s=t(2115),n=t(5695),o=t(9592),i=t(2767),l=t.n(i),c=t(6766);function p(){let[e,a]=(0,s.useState)(""),[t,i]=(0,s.useState)(""),[p,_]=(0,s.useState)(""),[d,u]=(0,s.useState)(null),[h,m]=(0,s.useState)(""),[b,f]=(0,s.useState)(!1),v=(0,n.useRouter)(),[x,j]=(0,s.useState)("now"),[g,w]=(0,s.useState)(""),G=async()=>{if(!d)return"";let e=new FormData;e.append("file",d);let a=await fetch("/api/admin/upload",{method:"POST",body:e}),t=await a.json();return t.success?(m(t.url),t.url):(alert("写真のアップロードに失敗しました"),"")},N=async a=>{a.preventDefault(),f(!0);try{let a=h;d&&!h&&(a=await G());let r={title:e,date:t,photoUrl:a,body:p,postType:x,publishAt:"reserve"===x?g:null,sent:"now"===x,createdAt:new Date().toISOString()},s=await fetch("/api/admin/notifications",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=await s.json();n.success?(alert("now"===x?"お知らせを送信しました":"お知らせを予約投稿しました"),v.push("/notifications/list")):alert("送信に失敗しました: "+n.message)}catch(e){console.error("送信エラー:",e),alert("送信に失敗しました")}finally{f(!1)}};return(0,r.jsxs)("div",{className:l().container,children:[(0,r.jsx)(o.B,{}),(0,r.jsxs)("main",{className:l().main,children:[(0,r.jsx)("h2",{className:l().main__title,children:"お知らせ送信"}),(0,r.jsxs)("form",{onSubmit:N,children:[(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"タイトル"}),(0,r.jsx)("input",{className:l().formGroup__input,value:e,onChange:e=>a(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"日付"}),(0,r.jsx)("input",{className:l().formGroup__input,type:"date",value:t,onChange:e=>i(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"写真"}),(0,r.jsx)("input",{className:l().formGroup__input,type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&u(e.target.files[0])}}),d&&(0,r.jsx)("button",{type:"button",onClick:G,children:"写真をアップロード"}),h&&(0,r.jsx)(c.default,{src:h,alt:"お知らせ画像",width:200,height:120,style:{marginTop:8,borderRadius:6,objectFit:"cover"}})]}),(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"投稿タイミング"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{children:[(0,r.jsx)("input",{type:"radio",name:"postType",value:"now",checked:"now"===x,onChange:()=>j("now")}),"今すぐ投稿"]}),(0,r.jsxs)("label",{style:{marginLeft:16},children:[(0,r.jsx)("input",{type:"radio",name:"postType",value:"reserve",checked:"reserve"===x,onChange:()=>j("reserve")}),"予約投稿"]})]})]}),"reserve"===x&&(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"公開日時"}),(0,r.jsx)("input",{type:"datetime-local",className:l().formGroup__input,value:g,onChange:e=>w(e.target.value),required:!0})]}),(0,r.jsxs)("div",{className:l().formGroup,children:[(0,r.jsx)("label",{className:l().formGroup__label,children:"本文"}),(0,r.jsx)("textarea",{className:l().formGroup__textarea,value:p,onChange:e=>_(e.target.value),required:!0,style:{minHeight:120}})]}),(0,r.jsx)("button",{type:"submit",className:l().submitButton,disabled:b,style:{marginTop:16},children:b?"送信中...":"送信"})]})]})]})}},9592:(e,a,t)=>{"use strict";t.d(a,{B:()=>u});var r=t(5155),s=t(6874),n=t.n(s),o=t(5695),i=t(2115),l=t(7016),c=t(7440),p=t(837),_=t.n(p),d=t(5671);function u(){let e=(0,o.usePathname)(),a=(0,o.useRouter)(),[t,s]=(0,i.useState)("");(0,i.useEffect)(()=>{let e=()=>{s(new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let a=setInterval(e,1e3);return()=>clearInterval(a)},[]);let p=async()=>{try{c.j6&&await (0,l.CI)(c.j6),await fetch("/api/auth/logout",{method:"POST"}),a.push("/auth/login")}catch(e){console.error("ログアウトエラー:",e)}};return(0,r.jsxs)("aside",{className:_().sidebar,children:[(0,r.jsxs)("div",{className:_().sidebar__header,children:[(0,r.jsx)("h1",{children:"PawTicket Admin"}),(0,r.jsx)("p",{children:"管理パネル"})]}),(0,r.jsx)("nav",{className:_().sidebar__nav,children:(0,r.jsx)("ul",{children:[{name:"ダッシュボード",path:"/",icon:"dashboard"},{name:"承認待ち",path:"/pending",icon:"clock"},{name:"承認済み",path:"/approved",icon:"check-circle"},{name:"却下済み",path:"/rejected",icon:"x-circle"},{name:"プッシュ通知",path:"/notifications",icon:"bell"},{name:"お知らせ一覧",path:"/notifications/list",icon:"bell"},{name:"お知らせ投稿",path:"/notifications/post",icon:"bell"}].map(a=>(0,r.jsx)("li",{children:(0,r.jsxs)(n(),{href:a.path,className:e===a.path?_().active:"",children:[(0,r.jsx)(d.I,{name:a.icon}),a.name]})},a.path))})}),(0,r.jsxs)("div",{className:_().sidebar__footer,children:[(0,r.jsxs)("div",{children:["現在時刻: ",t]}),(0,r.jsxs)("button",{onClick:p,style:{background:"none",border:"none",color:"#666",cursor:"pointer",fontSize:"0.9rem",marginTop:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)(d.I,{name:"logout"}),"ログアウト"]})]})]})}}},e=>{e.O(0,[174,779,566,568,874,766,441,964,358],()=>e(e.s=459)),_N_E=e.O()}]);