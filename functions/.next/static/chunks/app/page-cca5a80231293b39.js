(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{837:e=>{e.exports={dashboard:"app_dashboard__CLE5l",sidebar:"app_sidebar__mEgQl",sidebar__header:"app_sidebar__header__XCGER",sidebar__nav:"app_sidebar__nav__hamVG",active:"app_active__dPqO8",sidebar__footer:"app_sidebar__footer__970jN",content:"app_content__7IxbH",content__header:"app_content__header__KGob0",content__card:"app_content__card__WgF_T",content__card__stats:"app_content__card__stats__84M8b",authLoading:"app_authLoading__rYJvP",authError:"app_authError__E1poB","stat-card":"app_stat-card__zThVn",value:"app_value__A7nx1",icon:"app_icon___3bqa"}},3792:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>h});var t=s(5155),n=s(5695),i=s(2115),r=s(5145),c=s(837),d=s.n(c),l=s(9592);function o(){let[e,a]=(0,i.useState)({pending:0,approved:0,rejected:0,totalUsers:0,notifications:0}),[s,n]=(0,i.useState)([]),[r,c]=(0,i.useState)(!0),o=async()=>{try{var e,s;c(!0);let t=await fetch("/api/admin/dashboard"),i=await t.json();if(!i.success)return void console.error("API からの取得に失敗:",i.message);a({totalUsers:i.totalUsers,pending:i.pendingCount,approved:i.approvedCount,rejected:null!=(e=i.rejectedCount)?e:0,notifications:null!=(s=i.notifications)?s:0}),Array.isArray(i.recentActivities)?n(i.recentActivities):n([])}catch(e){console.error("ダッシュボードデータの取得に失敗しました:",e),a({pending:0,approved:0,rejected:0,totalUsers:0,notifications:0}),n(["データの取得に失敗しました"])}finally{c(!1)}};return(0,i.useEffect)(()=>{o()},[]),(0,t.jsxs)("div",{className:d().dashboard,children:[(0,t.jsx)(l.B,{}),(0,t.jsxs)("main",{className:d().content,children:[(0,t.jsxs)("div",{className:d().content__header,children:[(0,t.jsx)("h2",{children:"ダッシュボード"}),(0,t.jsx)("button",{onClick:o,style:{padding:"0.5rem 1rem",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"0.25rem",cursor:"pointer"},children:"データを更新"})]}),(0,t.jsxs)("div",{className:d().content__card,children:[(0,t.jsx)("h3",{children:"概要"}),r?(0,t.jsx)("div",{style:{textAlign:"center",padding:"2rem"},children:(0,t.jsx)("p",{children:"データを読み込み中..."})}):(0,t.jsxs)("div",{className:d().content__card__stats,children:[(0,t.jsxs)("div",{className:d()["stat-card"],children:[(0,t.jsx)("div",{className:d().icon}),(0,t.jsx)("h4",{children:"承認待ち"}),(0,t.jsx)("div",{className:d().value,children:e.pending})]}),(0,t.jsxs)("div",{className:d()["stat-card"],children:[(0,t.jsx)("div",{className:d().icon}),(0,t.jsx)("h4",{children:"承認済み"}),(0,t.jsx)("div",{className:d().value,children:e.approved})]}),(0,t.jsxs)("div",{className:d()["stat-card"],children:[(0,t.jsx)("div",{className:d().icon}),(0,t.jsx)("h4",{children:"通知送信数"}),(0,t.jsx)("div",{className:d().value,children:e.notifications})]}),(0,t.jsxs)("div",{className:d()["stat-card"],children:[(0,t.jsx)("div",{className:d().icon}),(0,t.jsx)("h4",{children:"総ユーザー数"}),(0,t.jsx)("div",{className:d().value,children:e.totalUsers})]})]})]}),(0,t.jsxs)("div",{className:d().content__card,children:[(0,t.jsx)("h3",{children:"最近の活動"}),r&&(0,t.jsx)("p",{children:"データを読み込み中..."}),!r&&s.length>0&&(0,t.jsx)("ul",{style:{listStyle:"none",padding:0},children:s.map((e,a)=>(0,t.jsxs)("li",{style:{padding:"0.5rem 0",borderBottom:"1px solid #eee",fontSize:"0.9rem"},children:["• ",e]},"activity-".concat(e.slice(0,20),"-").concat(a)))}),!r&&0===s.length&&(0,t.jsx)("p",{children:"最近のアクティビティはありません。"})]})]})]})}function h(){let{user:e,loading:a,isAdmin:s}=(0,r.A)(),c=(0,n.useRouter)();return((0,i.useEffect)(()=>{if(!a){if(!e)return void c.push("/auth/login");s||console.warn("管理者権限が必要です")}},[e,a,s,c]),a)?(0,t.jsx)("div",{className:d().authLoading,children:"認証情報を確認中..."}):e?s?(0,t.jsx)(o,{}):(0,t.jsx)("div",{className:d().authError,children:"管理者権限が必要です"}):(0,t.jsx)("div",{className:d().authLoading,children:"ログインページにリダイレクト中..."})}},5145:(e,a,s)=>{"use strict";s.d(a,{A:()=>l,default:()=>h});var t=s(5155),n=s(2115),i=s(7016),r=s(7440),c=s(5695);let d=(0,n.createContext)({user:null,loading:!0,isAdmin:!1}),l=()=>(0,n.useContext)(d),o=["3S6PdCwFK2TjGgQMUBnGkp9gTn53","U0rr9czqZGbmR1khmfhUSuPXEtJ2","TpuMV2JJ6eMvT6ZDeVsjqGhjbli1"];function h(e){let{children:a}=e,[s,l]=(0,n.useState)(null),[h,p]=(0,n.useState)(!0),[u,_]=(0,n.useState)(!1),m=(0,c.useRouter)(),v=(0,c.usePathname)();(0,n.useEffect)(()=>{_(!0)},[]),(0,n.useEffect)(()=>{if(!r.j6)return void p(!1);let e=(0,i.hg)(r.j6,e=>{l(e),p(!1),e||"/auth/login"===v?e&&"/auth/login"===v&&(o.includes(e.uid)?m.push("/"):null===r.j6||void 0===r.j6||r.j6.signOut()):m.push("/auth/login")});return()=>e()},[m,v]);let j=!!s&&o.includes(s.uid),x={user:s,loading:h,isAdmin:j};return u?(0,t.jsx)(d.Provider,{value:x,children:a}):(0,t.jsx)(d.Provider,{value:x,children:(0,t.jsx)("div",{className:"app_authLoading__rYJvP",children:"認証情報を確認中..."})})}},5191:(e,a,s)=>{Promise.resolve().then(s.bind(s,3792))},5671:(e,a,s)=>{"use strict";s.d(a,{I:()=>i});var t=s(5155);let n={"x-circle":"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm0-9.414l2.828-2.829 1.415 1.415L13.414 12l2.829 2.828-1.415 1.415L12 13.414l-2.828 2.829-1.415-1.415L10.586 12 7.757 9.172l1.415-1.415L12 10.586z","check-circle":"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.997-6l7.07-7.071-1.414-1.414-5.656 5.657-2.829-2.829-1.414 1.414L11.003 16z",clock:"M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm0-2a8 8 0 1 0 0-16 8 8 0 0 0 0 16zm1-8h4v2h-6V7h2v5z",bell:"M12 22a2.98 2.98 0 0 0 2.818-2H9.182A2.98 2.98 0 0 0 12 22zm7-7.414V10c0-3.217-2.185-5.927-5.145-6.742C13.562 2.52 12.846 2 12 2s-1.562.52-1.855 1.258C7.185 4.074 5 6.783 5 10v4.586l-1.707 1.707A1 1 0 0 0 3 17v1a1 1 0 0 0 1 1h16a1 1 0 0 0 1-1v-1a1 1 0 0 0-.293-.707L19 14.586z",dashboard:"M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z",close:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z",logout:"M16 13v-2H7V8l-5 4 5 4v-3z M20 3h-9c-1.103 0-2 .897-2 2v4h2V5h9v14h-9v-4H9v4c0 1.103.897 2 2 2h9c1.103 0 2-.897 2-2V5c0-1.103-.897-2-2-2z"},i=e=>{let{name:a,size:s=24,className:i=""}=e,r=n[a];return r?(0,t.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",width:s,height:s,className:i,children:(0,t.jsx)("path",{d:r})}):(console.warn('Icon "'.concat(a,'" not found')),null)}},7440:(e,a,s)=>{"use strict";let t,n;s.d(a,{j6:()=>o});var i=s(2479),r=s(7016),c=s(3681),d=s(7398);t=0===(0,i.Dk)().length?(0,i.Wp)({apiKey:"AIzaSyAjmdbaSlO2PJtnThYOI9mrpsoBgq6JWDc",authDomain:"pt-admin-4d877.firebaseapp.com",projectId:"pt-admin-4d877",storageBucket:"pt-admin-4d877.firebasestorage.app",messagingSenderId:"420928013456",appId:"1:420928013456:web:42cde435f10b1949c30415",measurementId:"G-9GWH9VTJP6"}):(0,i.Sx)();let l="appExpo";try{n=(0,i.Sx)(l)}catch(e){n=(0,i.Wp)({apiKey:"AIzaSyBTE5Gpz4rnnVhlDXQA3Va4DNARIhhJhrk",authDomain:"pawticket-6b651.firebaseapp.com",projectId:"pawticket-6b651",storageBucket:"pawticket-6b651.firebasestorage.app",messagingSenderId:"405389818227",appId:"1:405389818227:web:0f77dc15826b1eac13ed06",measurementId:"G-5YNTM317YJ"},l)}let o=(0,r.xI)(t);(0,c.aU)(t),(0,d.c7)(t),(0,c.aU)(n),(0,d.c7)(n)},9592:(e,a,s)=>{"use strict";s.d(a,{B:()=>u});var t=s(5155),n=s(6874),i=s.n(n),r=s(5695),c=s(2115),d=s(7016),l=s(7440),o=s(837),h=s.n(o),p=s(5671);function u(){let e=(0,r.usePathname)(),a=(0,r.useRouter)(),[s,n]=(0,c.useState)("");(0,c.useEffect)(()=>{let e=()=>{n(new Date().toLocaleTimeString("ja-JP",{hour:"2-digit",minute:"2-digit",second:"2-digit"}))};e();let a=setInterval(e,1e3);return()=>clearInterval(a)},[]);let o=async()=>{try{l.j6&&await (0,d.CI)(l.j6),await fetch("/api/auth/logout",{method:"POST"}),a.push("/auth/login")}catch(e){console.error("ログアウトエラー:",e)}};return(0,t.jsxs)("aside",{className:h().sidebar,children:[(0,t.jsxs)("div",{className:h().sidebar__header,children:[(0,t.jsx)("h1",{children:"PawTicket Admin"}),(0,t.jsx)("p",{children:"管理パネル"})]}),(0,t.jsx)("nav",{className:h().sidebar__nav,children:(0,t.jsx)("ul",{children:[{name:"ダッシュボード",path:"/",icon:"dashboard"},{name:"承認待ち",path:"/pending",icon:"clock"},{name:"承認済み",path:"/approved",icon:"check-circle"},{name:"却下済み",path:"/rejected",icon:"x-circle"},{name:"プッシュ通知",path:"/notifications",icon:"bell"},{name:"お知らせ一覧",path:"/notifications/list",icon:"bell"},{name:"お知らせ投稿",path:"/notifications/post",icon:"bell"}].map(a=>(0,t.jsx)("li",{children:(0,t.jsxs)(i(),{href:a.path,className:e===a.path?h().active:"",children:[(0,t.jsx)(p.I,{name:a.icon}),a.name]})},a.path))})}),(0,t.jsxs)("div",{className:h().sidebar__footer,children:[(0,t.jsxs)("div",{children:["現在時刻: ",s]}),(0,t.jsxs)("button",{onClick:o,style:{background:"none",border:"none",color:"#666",cursor:"pointer",fontSize:"0.9rem",marginTop:"0.5rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,t.jsx)(p.I,{name:"logout"}),"ログアウト"]})]})]})}}},e=>{e.O(0,[174,779,566,568,874,441,964,358],()=>e(e.s=5191)),_N_E=e.O()}]);